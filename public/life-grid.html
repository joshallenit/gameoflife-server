<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="javascripts/jquery-1.11.2.min.js"></script>
    <script src="javascripts/raphael-min.js"></script>
    <script>
        var width = 320;
        var height = 320;
        $(document).ready(function() {
            var grid = [
                [0, 0, 0, 0, 0, 1, 0],
                [0, 0, 0, 0, 0, 1, 0],
                [0, 0, 0, 0, 0, 1, 0],
                [0, 0, 0, 0, 0, 1, 0],
                [0, 1, 0, 0, 0, 1, 0],
                [0, 0, 0, 0, 0, 1, 0],
                [0, 0, 0, 0, 0, 1, 0]
            ];
            display(grid);
        });

        var display = function(grid) {
            // So here I make the Ajax request and draw the implementation... I am going to want an implementation...
            // So I'm going to need an entry screen
            // Start... submit

            var paper = Raphael(0, 0, width, height);

            var cellWidth = width / grid.length;
            var cellHeight = height / grid.length;

            $.each(grid, function(y, row) {
                $.each(row, function(x, alive) {
                    // Creates circle at x = 50, y = 40, with radius 10

                    var circle = paper.circle(x * cellWidth + (cellWidth/2), y * cellHeight + (cellHeight/2), Math.min(cellHeight/2, cellWidth/2));
                    if (alive) {
                        // Sets the fill attribute of the circle to red (#f00)
                        circle.attr("fill", "#f00");
                    } else {
                        circle.attr("fill", "#eeeeee");
                    }
                    // Sets the stroke attribute of the circle to white
                    circle.attr("stroke", "#fff");
                });
            });
            setTimeout(function() {
                iterate(grid);
            }, 500);
        }

        var iterate = function (grid) {
            console.log('iterating grid', grid);
            var gridParam = JSON.stringify(grid);
            $.ajax({
                url: '/life/iterate?grid=' + encodeURIComponent(gridParam)
            })
                    .done(function (data) {
                        display(data);
                    })
                    .fail(function () {
                        console.log('Could not get new grid', arguments);
                        alert("$.get failed!" + JSON.stringify(arguments));
                    });
        };
        // Okay so now I am going to want to check many different apps.. so we are going to have to download all of
        // the people's branches... checkout and run... and then connect to all of their apps and display them on one
        // screen, probably easier if I have the one app do it.. so I'll have /machine/iterate machine=xxx, because then
        // i don't have to worry about it
    </script>
</head>
<body>
<!-- Okay, so from here I am going to have to connect using ajax to get the next iteration -->

</body>
</html>